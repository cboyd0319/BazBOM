# Tests for supply chain tooling

package(default_visibility = ["//visibility:public"])

py_test(
    name = "test_purl_generator",
    srcs = [
        "test_purl_generator.py",
        "//tools/supplychain:purl_generator.py",
    ],
    size = "small",
)

py_test(
    name = "test_conflict_detector",
    srcs = [
        "test_conflict_detector.py",
        "//tools/supplychain:conflict_detector.py",
    ],
    size = "small",
)

py_test(
    name = "test_supply_chain_risk",
    srcs = [
        "test_supply_chain_risk.py",
        "//tools/supplychain:supply_chain_risk.py",
    ],
    size = "small",
)

py_test(
    name = "test_vex_processor",
    srcs = [
        "test_vex_processor.py",
        "//tools/supplychain:vex_processor.py",
    ],
    size = "small",
)

py_test(
    name = "test_extract_maven_deps",
    srcs = [
        "test_extract_maven_deps.py",
        "//tools/supplychain:extract_maven_deps.py",
    ],
    size = "small",
)

py_test(
    name = "test_policy_check",
    srcs = [
        "test_policy_check.py",
        "//tools/supplychain:policy_check.py",
    ],
    size = "small",
)

py_test(
    name = "test_write_sbom",
    srcs = [
        "test_write_sbom.py",
        "//tools/supplychain:write_sbom.py",
    ],
    size = "small",
)

py_test(
    name = "test_sarif_adapter",
    srcs = [
        "test_sarif_adapter.py",
        "//tools/supplychain:sarif_adapter.py",
    ],
    size = "small",
)

py_test(
    name = "test_enrichment",
    srcs = [
        "test_enrichment.py",
        "//tools/supplychain:kev_enrichment.py",
        "//tools/supplychain:epss_enrichment.py",
        "//tools/supplychain:ghsa_enrichment.py",
        "//tools/supplychain:vulncheck_enrichment.py",
        "//tools/supplychain:vulnerability_enrichment.py",
    ],
    size = "medium",
)

py_test(
    name = "test_signing",
    srcs = [
        "test_signing.py",
        "//tools/supplychain:sbom_signing.py",
        "//tools/supplychain:rekor_integration.py",
        "//tools/supplychain:intoto_attestation.py",
        "//tools/supplychain:verify_sbom.py",
    ],
    size = "medium",
)

py_test(
    name = "test_ai_query_engine",
    srcs = [
        "test_ai_query_engine.py",
        "//tools/supplychain:ai_query_engine.py",
    ],
    size = "small",
)

py_test(
    name = "test_upgrade_recommender",
    srcs = [
        "test_upgrade_recommender.py",
        "//tools/supplychain:upgrade_recommender.py",
    ],
    size = "small",
)

# Test fixtures directory
filegroup(
    name = "fixtures",
    srcs = glob(["fixtures/**/*"]),
)
