<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOC 2 Compliance Report - {{ company_name }}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6; color: #333; max-width: 1200px;
            margin: 0 auto; padding: 40px 20px;
        }
        .header {
            border-bottom: 4px solid {{ brand_color }};
            padding-bottom: 20px; margin-bottom: 40px;
        }
        .header h1 { color: {{ brand_color }}; font-size: 32px; }
        .certificate {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px solid {{ brand_color }};
            padding: 40px; border-radius: 8px; margin: 40px 0;
            text-align: center;
        }
        .certificate h2 {
            font-size: 28px; color: {{ brand_color }}; margin-bottom: 20px;
        }
        .certificate .statement {
            font-size: 18px; line-height: 1.8; margin: 20px 0;
        }
        .criteria-table {
            width: 100%; border-collapse: collapse; margin: 20px 0;
        }
        .criteria-table th {
            background: {{ brand_color }}; color: white;
            padding: 12px; text-align: left;
        }
        .criteria-table td {
            padding: 12px; border-bottom: 1px solid #e9ecef;
        }
        .status-pass { color: #28a745; font-weight: 600; }
        .status-fail { color: #dc3545; font-weight: 600; }
        .footer {
            margin-top: 60px; padding-top: 20px;
            border-top: 1px solid #dee2e6;
            text-align: center; color: #666; font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>SOC 2 Compliance Report</h1>
        <p>Trust Services Criteria Assessment</p>
        <p style="margin-top: 10px; color: #666;">
            {{ company_name }} | {{ report_date }}
        </p>
    </div>

    <div class="certificate">
        <h2>üõ°Ô∏è SOC 2 Compliance Certificate</h2>
        <div class="statement">
            This is to certify that <strong>{{ company_name }}</strong><br>
            has conducted a comprehensive supply chain security assessment<br>
            against SOC 2 Trust Services Criteria (TSC)<br>
            as of <strong>{{ report_date }}</strong>
        </div>
        <p style="margin-top: 30px; font-size: 14px; color: #666;">
            Certificate ID: SBOM-{{ stats.scan_date | format_date('%Y%m%d-%H%M%S') }}
        </p>
    </div>

    <h2 style="color: {{ brand_color }}; margin: 40px 0 20px 0;">Trust Services Criteria Assessment</h2>
    
    <table class="criteria-table">
        <thead>
            <tr>
                <th>Criterion</th>
                <th>Description</th>
                <th>Status</th>
                <th>Details</th>
            </tr>
        </thead>
        <tbody>
            {% for criterion_id, criterion in soc2_criteria.items() %}
            <tr>
                <td><strong>{{ criterion_id }}</strong></td>
                <td>{{ criterion.name }}</td>
                <td class="{% if criterion.status == 'PASS' %}status-pass{% else %}status-fail{% endif %}">
                    {{ '‚úì PASS' if criterion.status == 'PASS' else '‚úó FAIL' }}
                </td>
                <td>{{ criterion.details }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h2 style="color: {{ brand_color }}; margin: 40px 0 20px 0;">Supply Chain Metrics</h2>
    
    <ul style="line-height: 2; padding-left: 20px;">
        <li><strong>Total Components Tracked:</strong> {{ stats.total_packages }}</li>
        <li><strong>Critical Vulnerabilities:</strong> {{ stats.critical_vulns }}</li>
        <li><strong>Known Exploited Vulnerabilities (KEV):</strong> {{ stats.kev_vulns }}</li>
        <li><strong>License Compliance Status:</strong> {{ stats.total_licenses }} licenses reviewed</li>
        <li><strong>SBOM Generated:</strong> SPDX 2.3 format</li>
        <li><strong>Attestation:</strong> {% if 'provenance' in data %}Signed with Sigstore{% else %}Not configured{% endif %}</li>
    </ul>

    <div class="footer">
        <p>&copy; {{ report_date[:4] }} {{ company_name }}. All rights reserved.</p>
        <p style="font-size: 12px; margin-top: 8px;">
            This report is generated automatically by BazBOM and does not constitute a formal SOC 2 audit.<br>
            For official SOC 2 certification, consult with an authorized auditor.
        </p>
    </div>
</body>
</html>
