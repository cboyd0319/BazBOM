<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audit Trail - {{ company_name }}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6; color: #333; max-width: 1200px;
            margin: 0 auto; padding: 40px 20px;
        }
        .header {
            border-bottom: 4px solid {{ brand_color }};
            padding-bottom: 20px; margin-bottom: 40px;
        }
        .header h1 { color: {{ brand_color }}; font-size: 32px; }
        .timeline {
            position: relative;
            padding-left: 40px;
            margin: 40px 0;
        }
        .timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #e9ecef;
        }
        .timeline-entry {
            position: relative;
            margin-bottom: 30px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 4px;
            border-left: 4px solid {{ brand_color }};
        }
        .timeline-entry::before {
            content: '';
            position: absolute;
            left: -33px;
            top: 25px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: {{ brand_color }};
            border: 3px solid white;
            box-shadow: 0 0 0 2px #e9ecef;
        }
        .timeline-entry .timestamp {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }
        .timeline-entry .action {
            font-size: 16px;
            font-weight: 600;
            color: {{ brand_color }};
            margin-bottom: 8px;
        }
        .timeline-entry .user {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }
        .timeline-entry .details {
            font-size: 14px;
            color: #333;
            line-height: 1.6;
        }
        .footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 1px solid #dee2e6;
            text-align: center;
            color: #666;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Audit Trail</h1>
        <p>Supply Chain Security Actions & Approvals</p>
        <p style="margin-top: 10px; color: #666;">
            {{ company_name }} | {{ report_date }}
        </p>
    </div>

    <div style="margin-bottom: 40px;">
        <p style="font-size: 16px; line-height: 1.8;">
            This audit trail documents all supply chain security activities, including
            SBOM generation, vulnerability scans, and approval decisions.
        </p>
        <p style="margin-top: 20px; font-size: 14px; color: #666;">
            <strong>Total Entries:</strong> {{ audit_entries | length }}<br>
            <strong>Report Period:</strong> {{ report_date }}<br>
            <strong>Status:</strong> Active monitoring
        </p>
    </div>

    <h2 style="color: {{ brand_color }}; margin: 40px 0 20px 0;">Activity Timeline</h2>

    <div class="timeline">
        {% for entry in audit_entries %}
        <div class="timeline-entry">
            <div class="timestamp">
                {{ entry.timestamp | format_date('%Y-%m-%d %H:%M:%S UTC') }}
            </div>
            <div class="action">{{ entry.action }}</div>
            <div class="user">ðŸ‘¤ {{ entry.user }}</div>
            <div class="details">{{ entry.details }}</div>
        </div>
        {% endfor %}
    </div>

    <div style="margin-top: 60px; padding: 20px; background: #d1ecf1; border-left: 4px solid #0c5460; border-radius: 4px;">
        <h3 style="color: #0c5460; margin-bottom: 10px;">ðŸ”’ Audit Integrity</h3>
        <p style="font-size: 14px; color: #0c5460; line-height: 1.8;">
            This audit trail is automatically generated and maintained by BazBOM.
            All entries are timestamped and include actor attribution.
            For compliance requirements, retain audit trails for the required period
            per your organization's data retention policy.
        </p>
    </div>

    <div class="footer">
        <p>&copy; {{ report_date[:4] }} {{ company_name }}. All rights reserved.</p>
        <p style="font-size: 12px; margin-top: 8px;">
            Generated by BazBOM - Automated audit trail tracking
        </p>
    </div>
</body>
</html>
